---
title: "ass2msb104grp2"
format: html
editor: visual
---

```{r}
#| label: setup
#| include: FALSE
library (tidyverse)
library (PxWebApiData)
library(readxl)
library(purrr)
library(dineq)
library(psych)
library(flextable)

```

In this assignment we build on the foundation we made in assignment 1.
Using the calculated regional inequality and gdp per capita, we estimate a simple cross-sectional Ordinary Least Squares (OLS) regression for the year 2017 in our selected countries, broken down by NUTS2-region.
The model examines if intraregional inequality - represented by a calculated Gini-coefficient of GDP per capita in each NUTS2 region - is associated with short-term economic development across NUTS2 regions:

$$
\text{Gini}_{i,2017} = \alpha + \beta \, \Delta \text{GDPpc}_{i,2016 \to 2017} + u_i
$$ Where:

-   $\text{Gini}_{i,2017}$ — Calculated Gini coefficient of region *i* in 2017 (regional GDP per capita inequality)\
-   $\Delta \text{GDPpc}_{i,2016 \to 2017}$ — percent change in GDP per capita from 2016 to 2017 in region *i*\
-   $\alpha$ — intercept term (baseline inequality when GDP-per-capita change is zero)\
-   $\beta$ — slope coefficient showing how inequality changes with a one-percentage-point increase in GDP-per-capita growth\
-   $u_i$ — error term capturing unobserved regional factors

```{r}
#Getting data from Tidyjoined (GDP, Poupulation), summing by Nuts2. Filtering by year 2016/2017 and mutating column for change in GDP.
GDPChange <- readRDS("./Data/Tidyjoined.rds") %>%
  select(NUTS2, Country, Time, `GDP Million EUR`, Population) %>%
  group_by(NUTS2, Country, Time) %>%
  summarise(
    "N2GDPSUM" = sum(`GDP Million EUR`, na.rm = TRUE),
    "N2POPSUM" = sum(Population, na.rm = TRUE),
    "N2GDPCAP"  = (N2GDPSUM * 1000000)/ N2POPSUM)%>%
  filter(Time > "2015" & Time < "2018")%>%
mutate(
    lagged_capita = dplyr::lag(N2GDPCAP),
    chg_gdpc = (N2GDPCAP - lagged_capita)/lagged_capita,
    chg_gdpc = 100 * chg_gdpc)
```

```{r}
#Joining the Gini dataset onto the filtered table showing GDPC change.
ineqgdpcjoined <- left_join(GDPChange, readRDS("./data/ginigdp.rds"),
by = join_by(NUTS2, Time), keep = FALSE)%>%
  filter(Time == "2017")
```

```{r}
lmineqgdpc <-
summary(lm(gini ~ chg_gdpc, data = ineqgdpcjoined)
)
```

```{r}
lmineqgdpc
```

If we take a look at the results of the model, we see that the intercept ($\hat{\alpha}=0.1336$) reflects average inequality when GDP growth is zero, while the slope ($\hat{\beta}=-0.0024$) suggests a small, negative, and statistically insignificant relationship between GDP-per-capita growth and regional inequality ($R^2=0.012$). We can determine that the relationship is statistically insignificant due to the very large P-value of 0,435. 

In other words, faster-growing NUTS2 regions in 2017 tended to have slightly lower inequality, but the effect is small and not statistically meaningful.
