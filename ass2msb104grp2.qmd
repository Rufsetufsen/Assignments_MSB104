---
title: "ass2msb104grp2"
format: html
editor: visual
---

```{r}
#| label: setup
#| include: FALSE
library (tidyverse)
library (PxWebApiData)
library(readxl)
library(purrr)
library(dineq)
library(psych)
library(flextable)
```

```{r}
#Removing the metadata from the top and bottom by defining the range.
raw_Labourforce <- read_excel("./Data/Labour force by NUTS2.xlsx", sheet = "Sheet 1", range = "A10:D66", col_types = "text")
#Dropping the first row to align time with years
   raw_Labourforce <- raw_Labourforce[-1,]
   names(raw_Labourforce)[1] <- "Geo_Codes"
   names(raw_Labourforce)[2] <- "Geo_Labels"
as_flextable(raw_Labourforce)
```


```{r}
# Making raw_Labourforce into long format.
tidy_Labourforce <- pivot_longer(data = raw_Labourforce,
             cols = c(-Geo_Codes, -Geo_Labels),
             names_to = "Time",
             values_to = "Thousand persons")
```


```{r}
#Removing the metadata from the top and bottom by defining the range.
raw_Unemployment <- read_excel("./Data/Unemployment rate NUTS2.xlsx", sheet = "Sheet 1", range = "A11:D68", col_types = "text")
#Dropping the first row to align time with years
   raw_Unemployment <- raw_Unemployment[-1,]
   names(raw_Unemployment)[1] <- "Geo_Codes"
   names(raw_Unemployment)[2] <- "Geo_Labels"
as_flextable(raw_Unemployment)
```

```{r}
# Making raw_Unemployment into long format.
tidy_Unemployment <- pivot_longer(data = raw_Unemployment,
             cols = c(-Geo_Codes, -Geo_Labels),
             names_to = "Time",
             values_to = "Percentage")
```


```{r}
#Removing the metadata from the top and bottom by defining the range.
raw_Population.density <- read_excel("./Data/Population density NUTS2.xlsx", sheet = "Sheet 1", range = "A8:D60", col_types = "text")
#Dropping the first row to align time with years
   raw_Population.density <- raw_Population.density[-1,]
   names(raw_Population.density)[1] <- "Geo_Codes"
   names(raw_Population.density)[2] <- "Geo_Labels"
as_flextable(raw_Population.density)
```

```{r}
# Making raw_Population.density into long format.
tidy_Populatiopn.density <- pivot_longer(data = raw_Population.density,
             cols = c(-Geo_Codes, -Geo_Labels),
             names_to = "Time",
             values_to = "Persons per square kilometre")
```



