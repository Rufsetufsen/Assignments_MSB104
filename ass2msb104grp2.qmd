---
title: "ass2msb104grp2"
format: html
editor: visual
---

```{r}
#| label: setup
#| include: FALSE
library (tidyverse)
library (PxWebApiData)
library(readxl)
library(purrr)
library(dineq)
library(psych)
library(flextable)

```

```{r}
#Getting data from Tidyjoined (GDP, Poupulation), summing by Nuts2. Filtering by year 2016/2017 and mutating column for change in GDP.
GDPChange <- readRDS("./Data/Tidyjoined.rds") %>%
  select(NUTS2, Country, Time, `GDP Million EUR`, Population) %>%
  group_by(NUTS2, Country, Time) %>%
  summarise(
    "N2GDPSUM" = sum(`GDP Million EUR`, na.rm = TRUE),
    "N2POPSUM" = sum(Population, na.rm = TRUE),
    "N2GDPCAP"  = (N2GDPSUM * 1000000)/ N2POPSUM)%>%
  filter(Time > "2015" & Time < "2018")%>%
mutate(
    lagged_capita = dplyr::lag(N2GDPCAP),
    chg_gdpc = (N2GDPCAP - lagged_capita)/lagged_capita,
    chg_gdpc = 100 * chg_gdpc)
```
```{r}
#Joining the Gini dataset onto the filtered table showing GDPC change.
ineqgdpcjoined <- left_join(GDPChange, readRDS("./data/ginigdp.rds"),
by = join_by(NUTS2, Time), keep = FALSE)
```

```{r}
lmineqgdpc <-
summary(lm(gini ~ chg_gdpc, data = ineqgdpcjoined)
)
```

```{r}
lmineqgdpc
```

