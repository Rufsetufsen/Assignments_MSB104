---
title: "Assignment 4:"
subtitle:  "Regional GDP Inequality in 4 Selected European Economies - Synthesised Results."
author: "Kristoffer Tufta and Harald Vika"
date: last-modified
date-format: "dddd D MMM, YYYY"
csl: apa7.csl
lang: en-GB
format:
  html: default
  typst:
    papersize: a4
  pdf: 
    documentclass: article
    number-sections: true
    keep-tex: true
    papersize: A4
    fig-pos: "H"
abstract: ""
editor: 
  markdown: 
    wrap: sentence
echo: false
bibliography: references.bib
---

```{r}
#| label: setup
#| include: FALSE
#| message: false
#| warning: false
library (tidyverse)
library (PxWebApiData)
library(readxl)
library(purrr)
library(dineq)
library(psych)
library(flextable)
library(modelsummary)
library(lmtest)
library(plm)
```

# Assignment 4 Consolidation of Key findings

## Abstract

## Introduction

```{r}
Gini_EUdata_full <- readRDS("./data/Gini_EUdata_Full.rds")
```

### Background

### Objetives

### Sinificance

## Literature Review - Kristoffer

### Previous Work

A central reference point for our work is @lessmann2017, who shows that the link between economic development and regional inequality is not linear.
Their results suggest something closer to an inverted-U (and in some cases N-shaped) pattern, where inequality tends to rise in the middle stages of development before falling again in high-income settings.
This gives a natural expectation that fast-growing regions may show lower inequality if they are already relatively advanced, while poorer or developing regions might move in the opposite direction.
Their work is also relevant because they rely on both traditional data and satellite-based luminosity data, which shows that inequality can be meaningfully captured even when official data is patchy — a recurring issue even in Eurostat datasets, as we experienced directly.

Eurostat’s own methodological documentation is also part of the relevant background.
Their notes on missing values help explain why regional GDP and population numbers are incomplete in certain years.
These gaps arise from reclassification of regions, confidentiality rules, or delayed reporting.
Understanding why these "quirks" happen is important because it directly affects our results.

For our segmentation work, we also build on Eurostat’s definitions of population-density classes used for identifying rural areas, urban clusters, and high-density urban centres.
While Eurostat’s approach operates at the 1 km² continuous grid-cell level, their breakpoints (300 and 1500 people per square kilometer) give a practical structure for grouping NUTS2 regions by density.
This matters because urban density is often correlated with both productivity and access to public-services, and therefore a likely influence when it comes to regional GDP inequality.

### Research Gap

While there is existing literature on national GDP inequality trends and on broader development patterns, there is less focus on how short-term growth shocks play out inside individual NUTS2 regions, and even less on whether the effect of growth differs across structural categories like urban density, unemployment rates, or workforce size.
Our assignments aim to examine exactly that: to see whether any of these structural categories influence GDP inequality in NUTS2-regions, and if so, to what degree.

## Data and Methodology

### Data Sources - Harald

Primary data refers to information collected firsthand by the researcher directly from original source.
It is raw and unprocessed, typically gathered through methods such as surveys, interviews and observations.
The data provided by Eurostat can be considered primary data because it is originally collected through official surveys and processed following established methodological standards for gathering information on specific topic within defined time periods.

In the first assignment, we used Eurostat to extract datasets on gross domestic product (GDP) at current market prices by NUTS 3 regions.
From these datasets, we collected data for Germany, Ireland, Croatia annd Switzerland covering the years 2000 to 2023.

In the second assignment, we retrieved data from three additional datasets that could potentially influence regional inequality in 2017.
These datasets included labour force by NUTS 2 region, unemployment rate by Nuts 2 region, and population density by NUTS 2 region.
Each country collects its own data and reports it to Eurostat in accordance with ESA 2010, a global framework for national accounting.
This ensures that the resulting statistics are consistent, reliable, and comparable across countries.

However, the data also comes with certain limitations.
For example, Switzerland is not en EU member but an EFTA country (European Free Trade Association), which promotes free trade and economic cooperation.
Because Switzerland did not have a formal datasharing agreement with Eurostate before 2008, some data for earlier years or specific topics may be missing [@informat].

Another limitation relates to confidentiality.
Ireland, for instance, lacks GDP data for 2015-2017 in the Mid-West and South-West regions due to confidentiality restrictions imposed by Ireland's Central Statistics Office.
These restrictions are linked to changes in the national accounts in 2015 that significantly affected the measurement of Ireland's productive capacity [@countyi2018].

Some counters also choose to delay the publication of certain statistics to ensure accuracy.
As a result, data for the most recent years of 2022 and 2023, may still be incomplete due to its unavailability.

A common limitation across several datasets concerns changes in regional boundaries.
Regions may merge to form larger areas or split into smaller units, affecting how data is collected, aggregated and updated.
This issue is particularly relevant in Germany, where regional reforms occur more frequntly due to regional policy.
Coratia and Ireland face similar challenges, as changes to their NUTS regions have affected population data availability at the NUTS 3 level.

Finally, there were limitations related to the time coverage of the datasets.
Althought the assignments aimed to examine data from 2000 to 2023, the population density dataset for NUTS 2 regions only covers 2012-2023, and the unemployment rate dataset covers 2013-2023.
Consequently, when including these variables, we were restricted to using data from 2013 to 2023 to maintain consistency across datasets.

### Methodological approach - Kristoffer

#### Cross-Sectional Estimation

We first combined the Eurostat datasets covering GDP (in million euros) and population, , then calculated GDP per capita and Gini coefficients using a formula weighted by population, like @lessmann2017.
We then visualized the calculated Gini coefficients for the different regions using different plots from ggplot2.
In assignment 2, we made a cross-sectional analysis of the year 2017 using a regression model to test the effect of change in regional GDP per capita on regional inequality.
We specified the following linear regression model: $$
\text{Gini}_{i,2017} = \alpha + \beta \, \Delta \text{GDPpc}_{i,2016 \to 2017} + u_i
$$ Where:

-   $\text{Gini}_{i,2017}$ — Calculated Gini coefficient of region *i* in 2017 (regional GDP per capita inequality)\
-   $\Delta \text{GDPpc}_{i,2016 \to 2017}$ — percent change in GDP per capita from 2016 to 2017 in region *i*\
-   $\alpha$ — intercept term (baseline inequality when GDP-per-capita change is zero)\
-   $\beta$ — slope coefficient showing how inequality changes with a one-percentage-point increase in GDP-per-capita growth\
-   $u_i$ — error term capturing unobserved regional factors

We then experimented with other determinants of inequality by making a new OLS model with a set of new variables: population density (persons per square kilometer), unemployment rate and total workforce, also fetched from Eurostat.
We specified the MLR as follows: $$
\text{Gini}_{i,2017} = \alpha + \beta_1\,\text{Workforce}_i + \beta_2\,\text{PopDensity}_i + \beta_3\,\text{Unemployment}_i + u_i
$$

where $\alpha$ is the intercept, $\beta_1$, $\beta_2$, and $\beta_3$ are the slope coefficients for each explanatory variable, and $u_i$ is the error term capturing unobserved factors affecting inequality.

#### Segmentation

We also segmented regions into categories to examine if the development–inequality relationship differed across different structural environments.
Population density was split into “Rural”, “Medium Density”, and “High Density” using Eurostat-inspired breakpoints (0–300, 300–1500, 1500+).
For workforce size, we used quantile-based grouping (Low, Medium, High).
Unemployment rate was also split into Low-High segments, but here we set the breakpoints manually at 0%-5%, 5%-10% and 10+%.
These subsets were used to run separate regressions for each group.

#### Panel Estimation

Finally, we estimated fixed-effects models using the full panel, applying plm() with region, country, year, and two-way effects.
Before estimation, we converted the dataset into a pdata.frame and cleaned remaining NA/Inf values to avoid dropped regions.
The panel models allowed us to control for all time-invariant regional characteristics, giving a "less noisy" picture of how regional GDP inequality changes inside regions over time.

#### Handling of NA-values and Heteroskedasticity

After joining the datasets onto eachother, including the new variables used for segmenting, we ended up with a few obvious gaps in our data and some NA/Inf rows.
These were removed to keep the panel consistent, but a side effect of this is that we only have panel data from 2013 onwards.

We also ran Breusch–Pagan tests to check for heteroskedasticity across all regressions.
Where alternative functional forms were required, we introduced quadratic and logarithmic transformations of the key variables and evaluated their residual behaviour the same way.

## Empirical Findings - Harald

### Cross- sectional Estimates

In assignment 2, we began with a cross-sectional analysis examining the relationship between regional inequality and short-term ecnonmic development, measured as the change in GDP per capita from 2016 to 2017.
The dependent variable in our model was regional inequality, measured by the Gini coefficent, and the independent variable was the change in GDP per capita.
The regression can be written as: $$
\text{Gini}_{i,2017} = \alpha + \beta \, \Delta \text{GDPpc}_{i,2016 \to 2017} + u_i
$$ This specification allows us to ecamine whether regions experiencing faster economic growth tend to converge or diverge in terms of inequality.

Explanation of th variables:

\- $\text{Gini}_{i,2017}$ — Calculated Gini coefficient of region *i* in 2017 (regional GDP per capita inequality)\
- $\Delta \text{GDPpc}_{i,2016 \to 2017}$ — Precentage change in GDP per capita from 2016 to 2017 in region *i*\
- $\alpha$ — intercept term (baseline inequality when GDP-per-capita change is zero)\
- $\beta$ — slope coefficient indicating how inequality changes with a one-percentage-point increase in GDP-per-capita growth\
- $u_i$ — error term capturing unobserved regional factors

THe regression was estimated in the following table:

```{r}
read_rds("./data/Regdev-Gini.rds")
```

The results shows an estimated intercept of ($\hat{\alpha}=0.1336$), representing the average level of inequality in regions with zero GDP-per-capita growth.
The coefficient for GDP-per-capita growth is negative ($\hat{\beta}=-0.0024$), which indicates a slight negative relationship between economic growth and inequality.
However, the model's explanatory power is extremely low, with ($R^2=0.012$), meaning that changes in GDP-per-capita account for only 1.2% of the variation in inequality.
Thus, although the coefficient suggests a negative relationship, the effect is statistically insignificant and not substantively meaningful.
We can conclude that the short-term GDP-per-capita growth does has a small to none explanatory power for regional inequality in this analyse.

We then went on to collect three more variables to determine whether they serve as strong predictor of regional inequality then GDP-per-capita growth.
These variables were labour force, unemployment rate, and population density.
After cleaning and tiding the data, we estimated a multiple regression model to analyse their cross-sectional relationship with inequality: $$
\text{Gini}_{i,2017} = \alpha + \beta_1\,\text{Workforce}_i + \beta_2\,\text{PopDensity}_i + \beta_3\,\text{Unemployment}_i + u_i
$$

Each variable explained:

-   $\text{Gini}_{i,2017}$ — Calculated Gini coefficient of region *i* in 2017 (regional GDP per capita inequality)
-   $\Delta \text{Workforce}_{i}$ — Total labour force in region i, including both employed and unemployed individuals
-   $\Delta \text{PopDensity}_{i}$ — Population density of region i, indicating how densely populated the region is
-   $\Delta \text{Unemployment}_{i}$ — Unemployment rate in region i, representing presons withouth work who are available and is seeking work.
-   $\alpha$ — intercept term (baseline inequality when the variables change is zero)
-   $\beta_1, \beta_2, \beta_3$ — Coefficient showing how inequality changes with a one-percentage-point change in each variable
-   $u_i$ — error term capturing unobserved regional factors

Running the regression model gave us the table:

```{r}
read_rds("./data/tbl-MLR-All.rds")
```

This model gives us a R² of 0,283 and an adjusted R² of 0,235 meaning that the these three variables together has a 28% explanatory power of the variation in regional inequality, which is higher then the change in GDP-per-capita.
Below we discuss each predictor individually.

Workforce: The workforce variable is statistically significant at the 5% level (p = 0.0216).
Its coefficient, $\beta = 0.000043$, implies that regional inequality increases slightly as the labour force grows by one thousand workers.
This may reflect that regions with larger or more active labour markets experience greater occupational and wage diversity, leading to somewhat higher inequality.

Population density: Population density is statistically significant at the 1% level (p = 0.0083) and has a negative coefficient ($\beta = -0.000041$).
This suggests that more densely populated—typically more urbanized—regions tend to have lower inequality, possibly due to better access to education, more specialized employment opportunities, and a broader labour market.

Unemployment rate: The unemployment variable has a coefficient of $\beta = -0.0114$ and is marginally significant at the 10% level (p = 0.0613).
The negative sign indicates that regions with higher unemployment rates appear to have lower inequality, although the weak significance prevents us from drawing a firm conclusion.

Overall assessment: Both labour force size and population density are stronger predictors of regional inequality than short-term GDP-per-capita growth.
These structural variables appear to better capture regional economic differences than year-to-year changes in output.

### Alternative functional forms and panel estimates

In the Alternative functional forms part of the assignment we used the different variables from the second assignment, workforce, population density and unemployment rate, with the change in GDP, to explore other forms like logarithmic, quadratic and cubic.
We went for the logarithmic and quadratic functions, as the cubic gave more estimates but with less effect.
We would make a table for each functional form: linear, logarithmic and quadratic, and compare which of them is the most compatible.
Here we would then present the key findings in these regression analyses and explain the effect it has on its dependable variable, which is the gini-coefficient.

Workforce: Lets start off with workforce.
We start off with the linear model, and it gave the regional inequality coefficent a estimated value of $\beta = 0.177303$ when both the independent variables are at zero. Workforce gave a  estimated of $\beta = 0.000036$ and change in GDP-per-capita gave a $\beta = -0.002122$, however both the explanatory variables has no clear significant as the workforce has a p value of 0.0665 which is under the 10% and is a marginal significant but change GDP-per-capita we got a p value of 0.4931 which tells us its not significant.
Even with the combined f-test gives us a 1.877 and a p value of 0.163 which tells us that the model in its total is not significant The ($R^2=0.07397$) gives us a low percent of 7.4% and the adjusted ($R^2=0.00347$) gives us a even lower percent of 3.5 % which also tells us the model has a too low explanatory power.
The logarithmic model however gives off a stronger performers then the linear one.
Here we transform the variable change GDP-per-capita with a log-transformation, which helps with the realtionship with the dependable variable.
The estimates of change GDP-per-capita went to ($\beta = -0.059611$) which is a swap from positive to negative effect on the gini-coefficient, while the workforce only reduced to ($\beta = 0.000033$) which is hardly any change.
The most important effect of this model however is the change in p-value for change GDP-per-capita with a value of 0.0008.
This means its highly statistically significant.
The workforce variable continues to have the same p value of 0.0604 which gives a marginally significant.
The overall model has a ($R^2=0.2877$) and a adjusted ($R^2=0.0251$), which tells us that this model gives a better improvment in explanatory power then the linear one.
At last the F-test gives a 8.078 and the overall p-value of the model is 0.0011, meaning the model as a whole is statistically significant.
The last alternative functional form is the quadratic model.
This form however gave us a higher p-value then the logarithmic one on all of the coefficients.
While the change in GDP-per-capita got a positive growth of ($\beta = 0.004327$) on the linear term and a negative of ($\beta = -0.000468$) on the quadratic term, we still got a p value of 0.4066 and a 0.1302, which is both not statistically significant.
The workforce coefficient estimate is reduced to a ($\beta = 0.000029$) and the p-value increased to 0.1480 which means the effect is statistically weak.
The Multiple R is ($R^2=0.1194$) and the adjusted R is ($R^2=0.06199$) which is worse then the logarithmic model.
The model as a whole has a p-value of 0.1160 which again tells us its not statistically significant.

Population density: We will then take a look at the population density.
In the linear model we got when change in GDP-per-capita and population density is zero, regional inequality has a estimated value of ($\beta = 0.1506$) and is highly significant.
Will they cant actually be zero, the population density coefficient gives a estimate negative value of ($\beta = -0.000037$) and a p-value of 0.0228, telling us its statistically significant at the 5% level, even if its only marginal.
Change in GDP-per-capita however is not significant with a p-value of 0.6166.
The model got a multiple ($R^2=0.111$) and a adjusted ($R^2=0.072$) which gives a suggestion that the model lacks important factors cause of the low procent.
The f-statistic p-value gives a 0.00668 which it barely passes as a significant model.
In the logarithmic model for population density, the estimated value for the gini-coefficient haves a rise to ($\beta = 0.2292$) when the others are at zero.
When the change in GDP-per-capita gets log-transformation, it changes its estimates to a negative value of ($\beta = -0.05793$) and the p-value changes to 0.0007, meaning its highly significant.
The population density is almost at the same estimated value at ($\beta = -0.000039$) and at p-value of 0.0047 which means its still statistically significant.
The model gives a multiple $R^2=0.364$ and a adjusted $R^2=0.331$ which is an improvement from the linear model and gives it a stronger explanatory power.
The total p-value of the model is 0.0001 which tells us its highly significant overall.
We then used the quadratic regression model for population density where the GDP-per-capita growth has a nonlinear effect on regional inequality.
The estimated value for the gini-coefficient had fallen to $\beta = 0.1379$ when others are at zero. Here the linear change in GDP-per-capita has a estimated value of $\beta = 0.0077$ and a p-value of 0.1136 which means its not statistically significant, and the quadratic term for GDP-per-capita har a $\beta = -0.000682$ and a p-value of 0.0198 which means its statistically significant.
The population density coefficient gains a estimated value of $\beta = -0.000041$ and a p-value of 0.0091, meaning this one is also statistically significant.
It has a multiple $R^2=0.0.213$ and a adjusted $R^2=0.161$, which gives it a explanatory power between 21.3% and 16.1%.
The overall model gains a p-value of 0.0123 which means its statistically significant.

Unemployment rate: The linear model with the variable unemployment rate gives the gini-coeffisient a estimated value of $\beta = 0.175826$ when the other independent variables are equal zero. While the estimated value for change in GDP-per-capita is $\beta = -0.0000248$ and the p-value is of 0.936, which tells us its not statistically significant. The unemployment rate however gives a $\beta = -0.0010389$ and a p-value of 0.03 which tell us the coefficient is statistically significant. The model picks up a multiple $R^2=0.10$ and a adjusted $R^2=0.062$ which gives the model a small explanatory power. F-test gives a p-value of 0.083 which is at the borderline for 10% and the model is overall not statistically significant.
The logarithmic model gives the gini-coefficient a new estimate value of $\beta = 0.233016$ when the independent variables are zero. Here the change in GDP-per-capita gains a negative value of $\beta = 0.-0.051$ and a p-value of 0.005 which makes it statistically significant. The unemployment estimated value is still negative at $\beta = -0.00707$ and a p-value of 0.1096 which tells us it is not statistically significant. They have change from the linear model. The model's multiple $R^2=0.27$ and the adjusted $R^2=0.2336$ has increased, which have increased the explanatory power of the independent variables. The last F-test for the overall model gives a p-value of 0.0018 which means its highhly statistically significant. 
The last test as the others is the quadratic regression model. Here the dependent variable regional inequality gains a estimated value of $\beta = 0.1607$ when the independent variables are zero. The linear change in GDP-per-capita gains a positive estimate at $\beta = 0.0062$ but is not statistically significant at the p-value of 0.2114. The quadratic change in GDP-per-capita turns negative with the $\beta = -0.000488$ and is at the borderline significant with a p-value of 0.0102. Unemployment rate still have a estimated negative value of $\beta = -0.009216$ and the p-value of 0.0516 makes it also at the borderline of statistically significant. Overall model explanatory power is reduced as the multiple R is $R^2=0.1517$ and the adjusted R is $R^2=0.09633$. In the end the F-test gives it a p-value of 0.0539 which tells us the model is borderline significant overall. 

The panel regression results reveal a consistently positive association between chg_gdpc and the dependent variable across all specifications. The magnitude of the effect is small (0.00017–0.00024), but precision improves substantially when controlling for regional heterogeneity using NUTS2 fixed effects, as reflected in markedly lower standard errors and RMSE. Models with country-only or year-only fixed effects explain very little variation (R² = 0.005–0.009), whereas NUTS2 and NUTS2 & Year fixed effects substantially improve model fit (R² = 0.102–0.109) and are preferred according to AIC and BIC. These findings highlight the importance of accounting for subnational regional characteristics, which capture significant variation in the outcome variable. Overall, the results suggest that regional-level factors are key drivers of the dependent variable, while the positive effect of chg_gdpc remains robust across specifications.

## Discussion - Begynner kvar for oss, samskriver etterpå

### Key insights

### Policy Implications

## Limitations and Future Research - Harald

### Reasearch limitations

## Conclusion

### Summary

### Final Reflection

## References

## Appendix
